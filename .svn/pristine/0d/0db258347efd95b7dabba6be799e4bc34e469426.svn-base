webpackJsonp([83],{o0g4:function(e,a,r){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var t={data:function(){return{visible:!1,popuresuvisible:!1,dataForm:{resId:0,resName:null,icon:null,url:null,valid:"false",parentId:null,parentName:null,sortNo:null},resList:[],resListTreeProps:{label:"resName",children:"children"},dataRule:{resName:[{required:!0,message:"资源名称不能为空",trigger:"blur"}],url:[{required:!1,message:"资源路径不能为空",trigger:"blur"}],parentId:[{required:!0,message:"上级资源标识不能为空",trigger:"change"}],sortNo:[{required:!0,message:"排序不能为空",trigger:"blur"}]}}},methods:{init:function(){var e=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.dataForm.resId=a||0,this.dataForm.parentId=r||0,this.visible=!0,this.$http({url:this.$http.adornUrl("/sys/resinfo/list"),method:"get",params:this.$http.adornParams({isValid:"1"})}).then(function(a){var r=a.data;e.resList=r.list}).then(function(){e.visible=!0,e.$nextTick(function(){e.$refs.dataForm.resetFields(),e.dataForm.parentId=null,e.dataForm.parentName=null})}).then(function(){if(e.dataForm.resId&&e.$http({url:e.$http.adornUrl("/sys/resinfo/info/"+e.dataForm.resId),method:"get",params:e.$http.adornParams()}).then(function(a){var r=a.data;r&&0===r.code&&(e.dataForm.resName=r.sysResInfo.resName,e.dataForm.icon=r.sysResInfo.icon,e.dataForm.url=r.sysResInfo.url,e.dataForm.valid=1==r.sysResInfo.valid?"true":"false",e.dataForm.parentId=r.sysResInfo.parentId,e.dataForm.sortNo=r.sysResInfo.sortNo,e.resListTreeSetCurrentNode())}),r)for(var a in e.dataForm.parentId=r,e.resList)if(r==e.resList[a].resId)e.dataForm.parentName=e.resList[a].resName;else{var t=e.resList[a].children;for(var s in t)r==t[s].resId&&(e.dataForm.parentName=t[s].resName)}})},resListTreeCurrentChangeHandle:function(e,a){this.popuresuvisible=!1,this.dataForm.parentId=e.resId,this.dataForm.parentName=e.resName},resListTreeSetCurrentNode:function(){this.dataForm.parentId&&(this.$refs.resListTree.setCurrentKey(this.dataForm.parentId),this.dataForm.parentName=(this.$refs.resListTree.getCurrentNode()||{}).resName)},clearParentName:function(){this.dataForm.parentId=null,this.dataForm.parentName=null},dataFormSubmit:function(){var e=this;this.$refs.dataForm.validate(function(a){if(a){if(e.dataForm.resId&&e.dataForm.parentId===e.dataForm.resId)return void e.$message({message:"上级资源不能是其自身！",type:"warning"});e.$http({url:e.$http.adornUrl("/sys/resinfo/"+(e.dataForm.resId?"update":"save")),method:"post",data:e.$http.adornData({resId:e.dataForm.resId||void 0,resName:e.dataForm.resName,icon:e.dataForm.icon,url:e.dataForm.url,valid:"false"!==e.dataForm.valid,parentId:e.dataForm.parentId,sortNo:e.dataForm.sortNo})}).then(function(a){var r=a.data;r&&0===r.code?e.$message({message:"操作成功",type:"success",duration:1500,onClose:function(){e.visible=!1,e.$emit("refreshDataList")}}):e.$message.error(r.msg)})}})}}},s={render:function(){var e=this,a=e.$createElement,r=e._self._c||a;return r("el-dialog",{attrs:{title:e.dataForm.resId?"修改":"新增","close-on-click-modal":!1,visible:e.visible,center:"center"},on:{"update:visible":function(a){e.visible=a}}},[r("el-form",{ref:"dataForm",attrs:{model:e.dataForm,rules:e.dataRule,"label-width":"140px"},nativeOn:{keyup:function(a){if(!("button"in a)&&e._k(a.keyCode,"enter",13,a.key))return null;e.dataFormSubmit()}}},[r("el-form-item",{attrs:{label:"资源名称",prop:"resName"}},[r("el-input",{attrs:{placeholder:"资源名称"},model:{value:e.dataForm.resName,callback:function(a){e.$set(e.dataForm,"resName",a)},expression:"dataForm.resName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"资源路径",prop:"url"}},[r("el-input",{attrs:{placeholder:"资源路径"},model:{value:e.dataForm.url,callback:function(a){e.$set(e.dataForm,"url",a)},expression:"dataForm.url"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"是否为虚节点",prop:"valid"}},[r("el-radio",{attrs:{label:"false"},model:{value:e.dataForm.valid,callback:function(a){e.$set(e.dataForm,"valid",a)},expression:"dataForm.valid"}},[e._v("否")]),e._v(" "),r("el-radio",{attrs:{label:"true"},model:{value:e.dataForm.valid,callback:function(a){e.$set(e.dataForm,"valid",a)},expression:"dataForm.valid"}},[e._v("是")])],1),e._v(" "),r("el-form-item",{attrs:{label:"图标",prop:"icon"}},[r("el-input",{attrs:{placeholder:"图标"},model:{value:e.dataForm.icon,callback:function(a){e.$set(e.dataForm,"icon",a)},expression:"dataForm.icon"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"上级资源",prop:"parentName"}},[r("el-popover",{ref:"resListPopover",attrs:{placement:"bottom-start",trigger:"click"},model:{value:e.popuresuvisible,callback:function(a){e.popuresuvisible=a},expression:"popuresuvisible"}},[r("el-tree",{ref:"resListTree",attrs:{data:e.resList,props:e.resListTreeProps,"node-key":"resId","default-expand-all":!0,"highlight-current":!0,"expand-on-click-node":!1},on:{"current-change":e.resListTreeCurrentChangeHandle}})],1),e._v(" "),r("el-input",{directives:[{name:"popover",rawName:"v-popover:resListPopover",arg:"resListPopover"}],attrs:{placeholder:"上级资源",clearable:""},on:{clear:e.clearParentName},model:{value:e.dataForm.parentName,callback:function(a){e.$set(e.dataForm,"parentName",a)},expression:"dataForm.parentName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"排序号",prop:"sortNo"}},[r("el-input-number",{attrs:{"controls-position":"right",min:0,label:"排序号"},model:{value:e.dataForm.sortNo,callback:function(a){e.$set(e.dataForm,"sortNo",a)},expression:"dataForm.sortNo"}})],1)],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(a){e.visible=!1}}},[e._v("取消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(a){e.dataFormSubmit()}}},[e._v("确定")])],1)],1)},staticRenderFns:[]},o=r("46Yf")(t,s,!1,null,null,null);a.default=o.exports}});